import math

class arduinoFFT:
    # Constants
    FFT_FORWARD = 0x01
    FFT_REVERSE = 0x00

    FFT_WIN_TYP_RECTANGLE = 0x00
    FFT_WIN_TYP_HAMMING = 0x01
    FFT_WIN_TYP_HANN = 0x02
    FFT_WIN_TYP_TRIANGLE = 0x03
    FFT_WIN_TYP_NUTTALL = 0x04
    FFT_WIN_TYP_BLACKMAN = 0x05
    FFT_WIN_TYP_BLACKMAN_NUTTALL = 0x06
    FFT_WIN_TYP_BLACKMAN_HARRIS = 0x07
    FFT_WIN_TYP_FLT_TOP = 0x08
    FFT_WIN_TYP_WELCH = 0x09

    two_pi = 6.28318531
    four_pi = 12.56637061
    six_pi = 18.84955593

    def __init__(self, v_real, v_imag, samples, sampling_frequency):
        self.v_real = v_real
        self.v_imag = v_imag
        self.samples = samples
        self.sampling_frequency = sampling_frequency

    def _bit_reverse(self):
        for i in range(self.samples):
            j = self._bit_reverse_index(i)
            if i < j:
                self.v_real[i], self.v_real[j] = self.v_real[j], self.v_real[i]
                self.v_imag[i], self.v_imag[j] = self.v_imag[j], self.v_imag[i]

    def _bit_reverse_index(self, i):
        n = self.samples
        j = 0
        for k in range(int(math.log(n, 2))):
            j = (j << 1) | (i & 1)
            i >>= 1
        return j

    def _fft(self, dir):
        n = self.samples
        l = int(math.log(n, 2))
        for i in range(n):
            j = self._bit_reverse_index(i)
            if i < j:
                self.v_real[i], self.v_real[j] = self.v_real[j], self.v_real[i]
                self.v_imag[i], self.v_imag[j] = self.v_imag[j], self.v_imag[i]
        for s in range(1, l + 1):
            m = 1 << s
            wm_real = math.cos(self.two_pi / m)
            wm_imag = dir * math.sin(self.two_pi / m)
            for k in range(0, n, m):
                w_real = 1
                w_imag = 0
                for j in range(k, k + m // 2):
                    t_real = w_real * self.v_real[j + m // 2] - w_imag * self.v_imag[j + m // 2]
                    t_imag = w_real * self.v_imag[j + m // 2] + w_imag * self.v_real[j + m // 2]
                    self.v_real[j + m // 2] = self.v_real[j] - t_real
                    self.v_imag[j + m // 2] = self.v_imag[j] - t_imag
                    self.v_real[j] += t_real
                    self.v_imag[j] += t_imag
                    t_real = w_real * wm_real - w_imag * wm_imag
                    t_imag = w_real * wm_imag + w_imag * wm_real
                    w_real = t_real
                    w_imag = t_imag

    def compute(self, dir):
        self._bit_reverse()
        self._fft(dir)
    
    def ComplexToMagnitude(self):
        for i in range(self.samples):
          self.v_real[i] = math.sqrt(self.v_real[i] * self.v_real[i] + self.v_imag[i] * self.v_imag[i])
          self.v_imag[i] = 0


    def windowing(self, window_type, dir):
      samples_minus_one = self.samples - 1
      for i in range(self.samples // 2):
          index_minus_one = i
          ratio = index_minus_one / samples_minus_one
          weighing_factor = 1.0
          
          weighing_factor = 0.2810639 - (0.5208972 * math.cos(self.two_pi * ratio)) + (0.1980399 * math.cos(self.four_pi * ratio))
          if dir == self.FFT_FORWARD:
              self.v_real[i] *= weighing_factor
              self.v_real[self.samples - (i + 1)] *= weighing_factor
          else:
              self.v_real[i] /= weighing_factor
              self.v_real[self.samples - (i + 1)] /= weighing_factor

      
      

    def MajorPeak(self, f_min=0, f_max=None):
        if f_max is None:
            f_max = self.sampling_frequency / 2

        # Convert frequency range to indices
        i_min = int(f_min * self.samples / self.sampling_frequency)
        i_max = int(f_max * self.samples / self.sampling_frequency)

        # Find the maximum magnitude in the specified frequency range
        
        max_y = 0
        max_x = 0
        for i in range(i_min, i_max):
            if self.v_real[i] > max_y:
                max_y = self.v_real[i]
                max_x = i

        # Return the peak frequency
        return max_x*self.samples/self.sampling_frequency 




realcon = [0.0, 0.19509032201612825, 0.3826834323650898, 0.5555702330196022, 0.7071067811865475, 0.8314696123025452, 0.9238795325112867, 0.9807852804032304, 1.0, 0.9807852804032304, 0.9238795325112867, 0.8314696123025455, 0.7071067811865476, 0.5555702330196022, 0.3826834323650899, 0.1950903220161286, 1.2246467991473532e-16, -0.19509032201612836, -0.38268343236508967, -0.555570233019602, -0.7071067811865475, -0.8314696123025452, -0.9238795325112865, -0.9807852804032303, -1.0, -0.9807852804032304, -0.9238795325112866, -0.8314696123025455, -0.7071067811865477, -0.5555702330196022, -0.3826834323650904, -0.19509032201612872, -2.4492935982947064e-16, 0.19509032201612825, 0.38268343236508995, 0.5555702330196018, 0.7071067811865474, 0.8314696123025447, 0.9238795325112865, 0.9807852804032303, 1.0, 0.9807852804032307, 0.9238795325112867, 0.8314696123025456, 0.7071067811865483, 0.5555702330196038, 0.3826834323650905, 0.19509032201612972, 3.6739403974420594e-16, -0.19509032201612725, -0.38268343236508984, -0.5555702330196017, -0.7071067811865479, -0.8314696123025441, -0.9238795325112864, -0.9807852804032301, -1.0, -0.9807852804032307, -0.9238795325112867, -0.8314696123025456, -0.7071067811865485, -0.555570233019604, -0.3826834323650906, -0.19509032201612983, -4.898587196589413e-16, 0.19509032201612714, 0.3826834323650897, 0.5555702330196016, 0.7071067811865478, 0.831469612302545, 0.9238795325112864, 0.9807852804032304, 1.0, 0.980785280403231, 0.9238795325112875, 0.8314696123025467, 0.7071067811865486, 0.555570233019604, 0.3826834323650907, 0.19509032201612994, 6.123233995736766e-16, -0.195090322016127, -0.38268343236508795, -0.555570233019603, -0.7071067811865477, -0.831469612302545, -0.9238795325112863, -0.9807852804032301, -1.0, -0.9807852804032311, -0.9238795325112882, -0.8314696123025458, -0.7071067811865487, -0.5555702330196041, -0.3826834323650925, -0.19509032201612833, -7.347880794884119e-16, 0.1950903220161269, 0.38268343236508784, 0.5555702330196, 0.7071067811865476, 0.8314696123025449, 0.9238795325112863, 0.9807852804032301, 1.0, 0.9807852804032311, 0.9238795325112883, 0.8314696123025458, 0.7071067811865487, 0.5555702330196042, 0.3826834323650926, 0.19509032201612844, 8.572527594031472e-16, -0.19509032201612678, -0.38268343236508773, -0.5555702330195998, -0.7071067811865476, -0.8314696123025449, -0.9238795325112863, -0.9807852804032301, -1.0, -0.9807852804032311, -0.9238795325112883, -0.8314696123025459, -0.7071067811865488, -0.5555702330196043, -0.3826834323650927, -0.19509032201613205, -9.797174393178826e-16, 0.19509032201612664, 0.3826834323650876, 0.5555702330195997, 0.7071067811865475, 0.8314696123025448, 0.9238795325112862, 0.98078528040323, 1.0, 0.9807852804032304, 0.923879532511287, 0.8314696123025459, 0.7071067811865489, 0.5555702330196015, 0.38268343236508956, 0.1950903220161287, 1.102182119232618e-15, -0.19509032201612303, -0.38268343236508423, -0.5555702330195996, -0.7071067811865448, -0.8314696123025428, -0.9238795325112847, -0.98078528040323, -1.0, -0.9807852804032312, -0.9238795325112884, -0.831469612302548, -0.707106781186549, -0.5555702330196045, -0.38268343236509295, -0.1950903220161323, -1.2246467991473533e-15, 0.19509032201612642, 0.3826834323650874, 0.5555702330195995, 0.7071067811865448, 0.8314696123025427, 0.9238795325112874, 0.9807852804032307, 1.0, 0.9807852804032304, 0.9238795325112871, 0.8314696123025461, 0.7071067811865491, 0.5555702330196046, 0.38268343236509306, 0.19509032201612544, 4.899825157862589e-15, -0.1950903220161228, -0.382683432365084, -0.5555702330195965, -0.7071067811865421, -0.8314696123025407, -0.9238795325112861, -0.98078528040323, -1.0, -0.9807852804032312, -0.9238795325112885, -0.8314696123025481, -0.7071067811865517, -0.5555702330196077, -0.3826834323650899, -0.19509032201612905, -1.4695761589768238e-15, 0.19509032201612617, 0.3826834323650872, 0.5555702330195993, 0.7071067811865446, 0.8314696123025426, 0.9238795325112846, 0.9807852804032307, 1.0, 0.9807852804032305, 0.9238795325112872, 0.8314696123025462, 0.7071067811865492, 0.5555702330196048, 0.3826834323650933, 0.1950903220161257, -1.9606728399089416e-15, -0.19509032201612256, -0.3826834323650838, -0.5555702330195963, -0.707106781186542, -0.8314696123025405, -0.923879532511286, -0.9807852804032299, -1.0, -0.9807852804032312, -0.9238795325112886, -0.8314696123025482, -0.7071067811865519, -0.5555702330196078, -0.3826834323650901, -0.19509032201612928, -1.7145055188062944e-15, 0.19509032201612592, 0.38268343236508695, 0.5555702330195991, 0.7071067811865444, 0.8314696123025425, 0.9238795325112845, 0.9807852804032305, 1.0, 0.9807852804032305, 0.9238795325112873, 0.8314696123025463, 0.7071067811865495, 0.5555702330196051, 0.3826834323650935, 0.19509032201613288, 5.3896838775215305e-15, -0.1950903220161223, -0.38268343236508356, -0.5555702330195961, -0.7071067811865418, -0.8314696123025404, -0.9238795325112859, -0.9807852804032299, -1.0, -0.9807852804032313, -0.9238795325112886, -0.8314696123025485, -0.707106781186552, -0.5555702330196081, -0.3826834323650969, -0.19509032201612952, -1.959434878635765e-15, 0.1950903220161257, 0.38268343236508673, 0.555570233019599, 0.7071067811865442, 0.8314696123025422, 0.9238795325112844, 0.9807852804032305, 1.0, 0.9807852804032307, 0.9238795325112874, 0.8314696123025465, 0.7071067811865496, 0.5555702330196052, 0.3826834323650937, 0.19509032201613313, -1.4708141202500005e-15, -0.19509032201612905, -0.3826834323650899, -0.5555702330196017, -0.7071067811865467, -0.8314696123025442, -0.9238795325112857, -0.9807852804032298, -1.0, -0.98078528040323, -0.9238795325112861, -0.8314696123025446, -0.7071067811865471, -0.5555702330196024, -0.38268343236509056, -0.19509032201612977, -2.204364238465236e-15, 0.19509032201611848, 0.3826834323650799, 0.5555702330195929, 0.707106781186539, 0.8314696123025382, 0.9238795325112844, 0.9807852804032291, 1.0, 0.9807852804032321, 0.9238795325112902, 0.8314696123025506, 0.7071067811865548, 0.5555702330196114, 0.38268343236509395, 0.19509032201613338, 5.879542597180472e-15, -0.19509032201612184, -0.3826834323650831, -0.5555702330195956, -0.7071067811865415, -0.8314696123025401, -0.923879532511283, -0.9807852804032298, -1.0, -0.9807852804032314, -0.9238795325112888, -0.8314696123025487, -0.7071067811865523, -0.5555702330196085, -0.38268343236509733, -0.19509032201613, -2.4492935982947065e-15, 0.1950903220161252, 0.3826834323650863, 0.5555702330195985, 0.7071067811865439, 0.831469612302542, 0.9238795325112843, 0.9807852804032304, 1.0, 0.9807852804032308, 0.9238795325112903, 0.8314696123025468, 0.7071067811865449, 0.5555702330196056, 0.3826834323650876, 0.1950903220161336, -9.809554005910593e-16, -0.1950903220161216, -0.38268343236508945, -0.5555702330195954, -0.7071067811865464, -0.8314696123025479, -0.9238795325112856, -0.9807852804032311, -1.0, -0.9807852804032301, -0.923879532511289, -0.8314696123025449, -0.7071067811865526, -0.5555702330196027, -0.38268343236508445, -0.19509032201613025, -9.799650315725178e-15, 0.19509032201611104, 0.38268343236507946, 0.5555702330195983, 0.7071067811865387, 0.8314696123025419, 0.9238795325112814, 0.980785280403229, 1.0, 0.9807852804032322, 0.9238795325112931, 0.8314696123025509, 0.7071067811865501, 0.5555702330196117, 0.3826834323650944, 0.19509032201614082, 6.369401316839413e-15, -0.1950903220161144, -0.3826834323650826, -0.5555702330196012, -0.7071067811865411, -0.8314696123025438, -0.9238795325112827, -0.9807852804032297, -1.0, -0.9807852804032315, -0.9238795325112917, -0.8314696123025489, -0.7071067811865477, -0.555570233019609, -0.3826834323650912, -0.19509032201613746, -2.9391523179536475e-15, 0.19509032201611776, 0.3826834323650858, 0.5555702330195922, 0.7071067811865436, 0.8314696123025457, 0.9238795325112841, 0.9807852804032303, 1.0, 0.9807852804032309, 0.9238795325112905, 0.831469612302547, 0.7071067811865553, 0.5555702330196061, 0.38268343236508806, 0.1950903220161341, -4.91096680932118e-16, -0.19509032201612111, -0.382683432365089, -0.5555702330195951, -0.707106781186546, -0.8314696123025397, -0.9238795325112854, -0.980785280403231, -1.0, -0.9807852804032301, -0.9238795325112892, -0.8314696123025451, -0.7071067811865529, -0.5555702330196032, -0.3826834323650849, -0.19509032201613072, 3.921345679817883e-15, 0.19509032201611054, 0.382683432365079, 0.5555702330195978, 0.7071067811865384, 0.8314696123025416, 0.9238795325112813, 0.9807852804032289, 1.0, 0.9807852804032322, 0.9238795325112933, 0.8314696123025511, 0.7071067811865505, 0.5555702330196122, 0.3826834323650949, 0.1950903220161413, 6.859260036498355e-15, -0.1950903220161139, -0.3826834323650822, -0.555570233019589, -0.7071067811865408, -0.8314696123025435, -0.9238795325112826, -0.9807852804032295, -1.0, -0.9807852804032315, -0.923879532511292, -0.8314696123025492, -0.707106781186548, -0.5555702330196093, -0.38268343236509167, -0.19509032201613793, -3.429011037612589e-15, 0.19509032201611728, 0.38268343236508534, 0.5555702330195917, 0.7071067811865432, 0.8314696123025455, 0.9238795325112839, 0.9807852804032302, 1.0, 0.9807852804032309, 0.9238795325112906, 0.8314696123025473, 0.7071067811865557, 0.5555702330196064, 0.3826834323650885, 0.19509032201613458, -1.2379612731767154e-18, -0.19509032201612064, -0.3826834323650885, -0.5555702330195946, -0.7071067811865456, -0.8314696123025395, -0.9238795325112852, -0.9807852804032309, -1.0, -0.9807852804032302, -0.9238795325112893, -0.8314696123025455, -0.7071067811865532, -0.5555702330196036, -0.3826834323650985, -0.19509032201613122, -1.0779367755043061e-14, 0.19509032201611007, 0.38268343236507857, 0.5555702330195975, 0.707106781186538, 0.8314696123025413, 0.9238795325112811, 0.9807852804032288, 1.0, 0.9807852804032323, 0.9238795325112935, 0.8314696123025513, 0.7071067811865508, 0.5555702330196126, 0.38268343236509533, 0.1950903220161418, 7.349118756157295e-15, -0.19509032201611343, -0.38268343236508173, -0.5555702330195885, -0.7071067811865405, -0.8314696123025432, -0.9238795325112824, -0.9807852804032294, -1.0, -0.9807852804032317, -0.9238795325112922, -0.8314696123025495, -0.7071067811865585, -0.5555702330196097, -0.38268343236509217, -0.1950903220161384, -3.91886975727153e-15, 0.19509032201611679, 0.3826834323650849, 0.5555702330195914, 0.7071067811865428, 0.8314696123025372, 0.9238795325112837, 0.9807852804032301, 1.0, 0.980785280403231, 0.9238795325112908, 0.8314696123025476, 0.707106781186556, 0.5555702330196068, 0.382683432365089, 0.19509032201613505, 4.886207583857646e-16, -0.19509032201612017, -0.38268343236508806, -0.5555702330195942, -0.7071067811865452, -0.8314696123025391, -0.9238795325112851, -0.9807852804032309, -1.0, -0.9807852804032303, -0.9238795325112895, -0.8314696123025457, -0.7071067811865536, -0.555570233019604, -0.38268343236509894, -0.1950903220161317, 2.941628240500001e-15, 0.19509032201612353, 0.3826834323650912, 0.5555702330195971, 0.7071067811865477, 0.831469612302541, 0.9238795325112863, 0.9807852804032288, 1.0, 0.9807852804032297, 0.9238795325112882, 0.8314696123025438, 0.7071067811865511, 0.5555702330196012, 0.3826834323650958, 0.19509032201612833, 7.838977475816237e-15, -0.1950903220161269, -0.3826834323650944, -0.5555702330196, -0.7071067811865501, -0.8314696123025429, -0.9238795325112876, -0.9807852804032294, -1.0, -0.980785280403229, -0.9238795325112868, -0.8314696123025419, -0.7071067811865487, -0.5555702330195983, -0.3826834323650926, -0.19509032201612497, -4.408728476930472e-15, 0.19509032201610238, 0.38268343236507135, 0.555570233019591, 0.7071067811865325, 0.831469612302537, 0.9238795325112781, 0.9807852804032273, 1.0, 0.9807852804032339, 0.9238795325112965, 0.8314696123025558, 0.7071067811865563, 0.555570233019619, 0.38268343236510255, 0.19509032201614948, 1.518933419324671e-14, -0.19509032201610574, -0.3826834323650745, -0.5555702330195939, -0.7071067811865349, -0.8314696123025389, -0.9238795325112794, -0.980785280403228, -1.0, -0.9807852804032332, -0.9238795325112952, -0.8314696123025539, -0.7071067811865539, -0.5555702330196163, -0.3826834323650994, -0.19509032201614612, -1.1759085194360944e-14, 0.1950903220161091, 0.3826834323650777, 0.5555702330195849, 0.7071067811865374, 0.8314696123025408, 0.9238795325112807, 0.9807852804032287, 1.0, 0.9807852804032325, 0.9238795325112938, 0.8314696123025519, 0.7071067811865616, 0.5555702330196134, 0.3826834323650962, 0.19509032201614274, 8.328836195475178e-15, -0.19509032201611248, -0.38268343236508084, -0.5555702330195877, -0.7071067811865397, -0.8314696123025348, -0.9238795325112821, -0.9807852804032293, -1.0, -0.9807852804032319, -0.9238795325112925, -0.83146961230255, -0.7071067811865591, -0.5555702330196105, -0.38268343236509306, -0.19509032201613938, -4.898587196589413e-15, 0.19509032201611584, 0.382683432365084, 0.5555702330195905, 0.7071067811865421, 0.8314696123025367, 0.9238795325112833, 0.98078528040323, 1.0, 0.9807852804032312, 0.9238795325112912, 0.8314696123025481, 0.7071067811865567, 0.5555702330196195, 0.3826834323650899, 0.19509032201613602, 1.567919291290565e-14, -0.19509032201613313, -0.3826834323650872, -0.5555702330195934, -0.7071067811865346, -0.8314696123025465, -0.9238795325112846, -0.9807852804032279, -1.0, -0.9807852804032305, -0.9238795325112898, -0.8314696123025541, -0.7071067811865442, -0.5555702330196048, -0.38268343236509983, -0.1950903220161466, 1.9619108011821185e-15, 0.19509032201612256, 0.38268343236507724, 0.5555702330196081, 0.707106781186547, 0.8314696123025405, 0.9238795325112805, 0.9807852804032313, 1.0, 0.9807852804032327, 0.9238795325112832, 0.8314696123025443, 0.7071067811865519, 0.5555702330196138, 0.38268343236508356, 0.19509032201612928, 8.81869491513412e-15, -0.19509032201611198, -0.3826834323650935, -0.5555702330195991, -0.7071067811865394, -0.8314696123025503, -0.9238795325112873, -0.9807852804032292, -1.0, -0.9807852804032292, -0.9238795325112873, -0.8314696123025503, -0.7071067811865394, -0.5555702330195991, -0.3826834323650935, -0.19509032201613985, -1.9599300631450357e-14, 0.1950903220161014, 0.3826834323650573, 0.5555702330195902, 0.7071067811865318, 0.8314696123025286, 0.9238795325112832, 0.9807852804032271, 1.0, 0.9807852804032369, 0.9238795325112914, 0.8314696123025563, 0.7071067811865671, 0.5555702330196081, 0.38268343236510344, 0.19509032201615042, 3.0379906347766594e-14, -0.19509032201611873, -0.3826834323650736, -0.5555702330195812, -0.7071067811865241, -0.8314696123025384, -0.923879532511279, -0.980785280403225, -1.0, -0.9807852804032334, -0.9238795325112955, -0.8314696123025623, -0.7071067811865547, -0.555570233019617, -0.38268343236511343, -0.19509032201613313, -1.2738802633678827e-14, 0.19509032201610815, 0.38268343236506364, 0.5555702330195958, 0.7071067811865366, 0.8314696123025324, 0.9238795325112857, 0.9807852804032284, 1.0, 0.9807852804032355, 0.9238795325112887, 0.8314696123025525, 0.7071067811865622, 0.555570233019626, 0.3826834323650971, 0.1950903220161437, 2.3519408349995066e-14, -0.19509032201612544, -0.3826834323650799, -0.5555702330195869, -0.707106781186529, -0.8314696123025421, -0.9238795325112816, -0.9807852804032263, -1.0, -0.9807852804032321, -0.9238795325112928, -0.8314696123025584, -0.7071067811865498, -0.5555702330196114, -0.3826834323651071, -0.19509032201615428, -5.878304635907295e-15, 0.19509032201611487, 0.38268343236506996, 0.5555702330196015, 0.7071067811865415, 0.8314696123025361, 0.9238795325112775, 0.9807852804032298, 1.0, 0.9807852804032342, 0.9238795325112862, 0.8314696123025487, 0.7071067811865575, 0.5555702330196203, 0.3826834323650908, 0.19509032201613696, 1.6658910352223535e-14, -0.19509032201613216, -0.3826834323650863, -0.5555702330195926, -0.7071067811865338, -0.8314696123025459, -0.9238795325112843, -0.9807852804032277, -1.0, -0.9807852804032308, -0.9238795325112903, -0.8314696123025547, -0.7071067811865449, -0.5555702330196056, -0.3826834323651008, -0.19509032201614754, 9.82193361864236e-16, 0.19509032201612161, 0.3826834323650763, 0.5555702330196073, 0.7071067811865464, 0.83146961230254, 0.9238795325112802, 0.9807852804032311, 1.0, 0.9807852804032329, 0.9238795325112944, 0.8314696123025449, 0.7071067811865526, 0.5555702330196146, 0.38268343236508445, 0.19509032201613025, 9.798412354452001e-15, -0.19509032201611104, -0.3826834323650926, -0.5555702330195983, -0.7071067811865387, -0.8314696123025498, -0.9238795325112868, -0.980785280403229, -1.0, -0.9807852804032294, -0.9238795325112876, -0.8314696123025509, -0.70710678118654, -0.5555702330196, -0.3826834323650944, -0.19509032201614082, 7.842691359635767e-15, 0.19509032201610046, 0.38268343236505636, 0.5555702330195893, 0.707106781186531, 0.831469612302528, 0.9238795325112827, 0.9807852804032269, 1.0, 0.980785280403237, 0.9238795325112917, 0.8314696123025569, 0.7071067811865678, 0.555570233019609, 0.3826834323651044, 0.1950903220161514, 3.1359623787084476e-14, -0.19509032201611776, -0.3826834323650727, -0.5555702330195804, -0.7071067811865235, -0.8314696123025378, -0.9238795325112786, -0.9807852804032248, -1.0, -0.9807852804032335, -0.9238795325112958, -0.8314696123025628, -0.7071067811865553, -0.5555702330196178, -0.3826834323651143, -0.1950903220161341, -1.371852007299671e-14, 0.19509032201610718, 0.38268343236506275, 0.5555702330195951, 0.7071067811865359, 0.8314696123025318, 0.9238795325112745, 0.9807852804032282, 1.0, 0.9807852804032356, 0.9238795325112892, 0.831469612302553, 0.7071067811865629, 0.5555702330196268, 0.38268343236509805, 0.19509032201614468, 2.4499125789312947e-14, -0.19509032201612447, -0.382683432365079, -0.5555702330195861, -0.7071067811865283, -0.8314696123025416, -0.9238795325112813, -0.9807852804032261, -1.0, -0.9807852804032322, -0.9238795325112933, -0.831469612302559, -0.7071067811865505, -0.5555702330196122, -0.382683432365108, -0.19509032201615523, -6.858022075225178e-15, 0.1950903220161139, 0.3826834323650691, 0.5555702330196007, 0.7071067811865408, 0.8314696123025356, 0.9238795325112772, 0.9807852804032295, 1.0, 0.9807852804032343, 0.9238795325112865, 0.8314696123025492, 0.7071067811865581, 0.5555702330196212, 0.38268343236509167, 0.19509032201613793, 1.7638627791541416e-14, -0.19509032201610335, -0.38268343236508534, -0.5555702330195917, -0.7071067811865331, -0.8314696123025455, -0.9238795325112839, -0.9807852804032274, -1.0, -0.9807852804032309, -0.9238795325112906, -0.8314696123025552, -0.7071067811865456, -0.5555702330196064, -0.38268343236510166, -0.1950903220161485, 2.475922546353431e-18, 0.19509032201612064, 0.3826834323650754, 0.5555702330196065, 0.7071067811865456, 0.8314696123025395, 0.9238795325112797, 0.9807852804032309, 1.0, 0.980785280403233, 0.9238795325112947, 0.8314696123025455, 0.7071067811865532, 0.5555702330196154, 0.38268343236508534, 0.19509032201613122, 1.0778129793769884e-14, -0.19509032201611007, -0.3826834323650917, -0.5555702330195975, -0.707106781186538, -0.8314696123025492, -0.9238795325112865, -0.9807852804032288, -1.0, -0.9807852804032295, -0.9238795325112881, -0.8314696123025513, -0.7071067811865609, -0.5555702330196007, -0.38268343236509533, -0.1950903220161418, -2.1558735510086122e-14, 0.1950903220160995, 0.3826834323650555, 0.5555702330195885, 0.7071067811865304, 0.8314696123025275, 0.9238795325112824, 0.9807852804032267, 1.0, 0.9807852804032372, 0.9238795325112922, 0.8314696123025573, 0.7071067811865684, 0.5555702330196334, 0.38268343236510527, 0.19509032201615237, 3.2339341226402363e-14, -0.19509032201611679, -0.3826834323650718, -0.5555702330195795, -0.7071067811865227, -0.8314696123025372, -0.9238795325112783, -0.9807852804032247, -1.0, -0.9807852804032338, -0.9238795325112963, -0.8314696123025633, -0.707106781186556, -0.5555702330196187, -0.38268343236511526, -0.19509032201616294, -1.469823751231459e-14, 0.1950903220161062, 0.3826834323650618, 0.5555702330195942, 0.7071067811865352, 0.8314696123025312, 0.9238795325112742, 0.9807852804032281, 1.0, 0.9807852804032303, 0.9238795325112895, 0.8314696123025378, 0.7071067811865637, 0.555570233019604, 0.38268343236509894, 0.19509032201611776, 2.547884322863083e-14, -0.19509032201612353, -0.3826834323650781, -0.555570233019609, -0.7071067811865276, -0.831469612302541, -0.9238795325112809, -0.9807852804032315, -1.0, -0.9807852804032269, -0.9238795325112936, -0.8314696123025438, -0.7071067811865511, -0.5555702330195893, -0.3826834323651089, -0.19509032201612833]






samples=[0]*1024

for i in range(1024):
  samples[i] = realcon[i]


integerToFloat(samples, real, imag, SAMPLES);




fft.Windowing(FFT_WIN_TYP_FLT_TOP, FFT_FORWARD);

fft.Compute(FFT_FORWARD);


for (int i = 0; i < SAMPLES; i++)
    {
        // frequencies[i] = i * sampling_frequency ;
        printf("%f %f\n",real[i],imag[i]);
        // Serial.println(real[i]);
    }
